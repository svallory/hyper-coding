name: all
description: |
  Interactive setup wizard to configure your entire Next.js stack.
  Sets up database, UI library, state management, and more based on your choices.
  Can be re-run to update your configuration.
version: 1.0.0

variables:
  database:
    type: enum
    description: Choose a database ORM (or none)
    values: [none, prisma, drizzle]
    default: none

  ui:
    type: boolean
    description: Setup shadcn/ui component library?
    default: false

  stateManagement:
    type: boolean
    description: Setup TanStack Query for server state management?
    default: false

  auth:
    type: enum
    description: Choose an authentication provider (or none)
    values: [none, nextauth, clerk]
    default: none

steps:
  - name: Welcome message
    tool: shell
    command: |
      echo "üöÄ Next.js Stack Configuration Wizard"
      echo "======================================"
      echo ""
      echo "This wizard will help you configure your Next.js application stack."
      echo "You can re-run this recipe at any time to update your configuration."
      echo ""

  - name: Ask database choice
    tool: prompt
    message: Choose a database ORM (or skip)
    variable: database
    promptType: select
    options:
      - none
      - prisma
      - drizzle
    default: none

  - name: Ask UI library
    tool: prompt
    message: Setup shadcn/ui component library?
    variable: ui
    promptType: confirm
    default: false

  - name: Ask state management
    tool: prompt
    message: Setup TanStack Query for server state management?
    variable: stateManagement
    promptType: confirm
    default: false

  - name: Ask auth provider
    tool: prompt
    message: Choose an authentication provider (or skip)
    variable: auth
    promptType: select
    options:
      - none
      - nextauth
      - clerk
    default: none

  - name: Configuration summary
    tool: shell
    command: |
      echo ""
      echo "üìã Configuration Summary"
      echo "========================"
      echo "Database ORM: {{ database }}"
      echo "UI Library: @if(ui)shadcn/ui@else
      None@end"
      echo "State Management: @if(stateManagement)TanStack Query@else
      None@end"
      echo "Authentication: {{ auth }}"
      echo ""
      echo "Starting configuration..."
      echo ""

  - name: Setup Prisma
    tool: recipe
    recipe: ../prisma/recipe.yml
    when: database === 'prisma'
    variables:
      database: postgresql
      databaseUrl: ""

  - name: Setup Drizzle
    tool: recipe
    recipe: ../drizzle/recipe.yml
    when: database === 'drizzle'
    variables:
      database: postgresql
      databaseUrl: ""

  - name: Setup shadcn/ui
    tool: recipe
    recipe: ../shadcn/recipe.yml
    when: ui === true
    variables:
      primitives: baseui
      style: default
      baseColor: zinc
      cssVariables: true

  - name: Setup TanStack Query
    tool: recipe
    recipe: ../tanstack-query/recipe.yml
    when: stateManagement === true
    variables:
      withDevtools: true
      withPersister: false

  - name: Auth setup notice
    tool: shell
    when: auth === 'nextauth' || auth === 'clerk'
    command: |
      echo ""
      echo "‚ö†Ô∏è  Authentication setup for {{ auth }} is not yet implemented."
      echo "This feature will be added in a future version."
      echo ""

  - name: Completion message
    tool: shell
    command: |
      echo ""
      echo "‚úÖ Stack configuration completed!"
      echo ""
      echo "Next steps:"
      @if(database === 'prisma')
      echo "  ‚Ä¢ Update DATABASE_URL in .env with your database credentials"
      echo "  ‚Ä¢ Edit prisma/schema.prisma to define your data models"
      echo "  ‚Ä¢ Run 'npx prisma migrate dev --name init' to create your database"
      @else if(database === 'drizzle')
      echo "  ‚Ä¢ Update DATABASE_URL in .env with your database credentials"
      echo "  ‚Ä¢ Edit db/schema/*.ts to define your data models"
      echo "  ‚Ä¢ Run 'bun run db:generate' to generate migrations"
      echo "  ‚Ä¢ Run 'bun run db:migrate' to apply migrations"
      @end
      @if(ui)
      echo "  ‚Ä¢ Browse available components at https://ui.shadcn.com/docs/components"
      echo "  ‚Ä¢ Add more components with 'npx shadcn@latest add <component>'"
      @end
      @if(stateManagement)
      echo "  ‚Ä¢ Add <QueryProvider> to your root layout (see components/providers/query-provider.tsx)"
      echo "  ‚Ä¢ Create query hooks in the hooks/ directory"
      @end
      echo ""
      echo "You can re-run this recipe anytime with: hypergen nextjs config all"
      echo ""
