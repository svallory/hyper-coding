name: add
description: |
  Add a new page to a Next.js App Router project.
  Creates page.tsx in the appropriate route segment directory.
  Optionally generates loading.tsx, error.tsx, and a route-specific layout.
version: 1.0.0

variables:
  path:
    type: string
    description: |
      Route path relative to app/ (e.g. "about", "blog/[slug]", "dashboard/settings").
      Supports dynamic segments [param], catch-all [...slug], and optional catch-all [[...slug]].
    required: true

  pageDescription:
    type: string
    description: Brief description of what this page does
    required: true

  withLayout:
    type: boolean
    description: Also generate a layout.tsx for this route segment
    default: false

  withLoading:
    type: boolean
    description: Also generate a loading.tsx for this route segment
    default: false

  withError:
    type: boolean
    description: Also generate an error.tsx boundary for this route segment
    default: false

steps:
  - name: Create route directory
    tool: shell
    command: mkdir -p app/{{ path }}

  - name: Generate page scaffold
    tool: template
    template: templates/page.tsx.jig

  - name: Generate layout
    tool: recipe
    recipe: ../../layout/add/recipe.yml
    when: "withLayout === true"
    variables:
      path: "{{ path }}"
      layoutDescription: "Layout for {{ pageDescription }}"

  - name: Generate loading UI
    tool: recipe
    recipe: ../../loading/add/recipe.yml
    when: "withLoading === true"
    variables:
      path: "{{ path }}"

  - name: Generate error boundary
    tool: recipe
    recipe: ../../error/add/recipe.yml
    when: "withError === true"
    variables:
      path: "{{ path }}"
